<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Spatial data – Reproducible Road Safety Research with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08-join.html" rel="next">
<link href="./06-time.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-23102fe0f0b5b1a9f09cc09ebcc8fe5b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-space.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Spatial data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Reproducible Road Safety Research with R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/itsleeds/rrsrr" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preamble</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">R basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Using RStudio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-pkgs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">R packages</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Manipulating data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Temporal data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-space.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Spatial data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-join.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Joining road crash tables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-next.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Next steps</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sf-objects" id="toc-sf-objects" class="nav-link active" data-scroll-target="#sf-objects"><span class="header-section-number">7.1</span> sf objects</a></li>
  <li><a href="#reading-and-writing-spatial-data" id="toc-reading-and-writing-spatial-data" class="nav-link" data-scroll-target="#reading-and-writing-spatial-data"><span class="header-section-number">7.2</span> Reading and writing spatial data</a></li>
  <li><a href="#sf-polygons" id="toc-sf-polygons" class="nav-link" data-scroll-target="#sf-polygons"><span class="header-section-number">7.3</span> sf polygons</a></li>
  <li><a href="#spatial-subsetting-and-sf-plotting" id="toc-spatial-subsetting-and-sf-plotting" class="nav-link" data-scroll-target="#spatial-subsetting-and-sf-plotting"><span class="header-section-number">7.4</span> Spatial subsetting and sf plotting</a></li>
  <li><a href="#geographic-joins" id="toc-geographic-joins" class="nav-link" data-scroll-target="#geographic-joins"><span class="header-section-number">7.5</span> Geographic joins</a></li>
  <li><a href="#coordinate-reference-systems" id="toc-coordinate-reference-systems" class="nav-link" data-scroll-target="#coordinate-reference-systems"><span class="header-section-number">7.6</span> Coordinate Reference Systems</a></li>
  <li><a href="#buffers" id="toc-buffers" class="nav-link" data-scroll-target="#buffers"><span class="header-section-number">7.7</span> Buffers</a></li>
  <li><a href="#attribute-operations-on-sf-objects" id="toc-attribute-operations-on-sf-objects" class="nav-link" data-scroll-target="#attribute-operations-on-sf-objects"><span class="header-section-number">7.8</span> Attribute operations on sf objects</a></li>
  <li><a href="#mapping-road-crash-data" id="toc-mapping-road-crash-data" class="nav-link" data-scroll-target="#mapping-road-crash-data"><span class="header-section-number">7.9</span> Mapping road crash data</a></li>
  <li><a href="#analysing-point-data" id="toc-analysing-point-data" class="nav-link" data-scroll-target="#analysing-point-data"><span class="header-section-number">7.10</span> Analysing point data</a></li>
  <li><a href="#bonus-exercises" id="toc-bonus-exercises" class="nav-link" data-scroll-target="#bonus-exercises">Bonus exercises</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/itsleeds/rrsrr/edit/main/07-space.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/itsleeds/rrsrr/blob/main/07-space.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/itsleeds/rrsrr/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="space" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Spatial data</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>From displaying simple point data to examining collision density along routes or between areas, the geographic property of STATS19 data is one of its most useful attributes. Mapping is a hugely useful and powerful aspect of R and has many applications in road safety, both in understanding geographic trends and presenting insight to colleagues. This aspect of R is covered in detail in the book <a href="https://geocompr.robinlovelace.net/index.html">Geocomputation With R</a>. By mapping collision data in R, you can add layers containing other geographic datasets to further understand the reasons for certain trends. This can lead to new opportunities for intervention and collaboration with other parties who may have mutually compatible solutions for reaching their goals. We will use the following packages in this section:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)        <span class="co"># load the sf package for working with spatial data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># load the tidyverse as before</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sf-objects" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="sf-objects"><span class="header-section-number">7.1</span> sf objects</h2>
<p>All road crashes happen somewhere and, in the UK at least, all collisions recorded by the police are given geographic coordinates. These can help in prioritising interventions to save lives by focusing on ‘crash hotspots.’ R has strong geographic data capabilities with the <code>sf</code> package, providing a generic class for spatial vector data. Points, lines and polygons are represented in <code>sf</code> as objects in a special ‘geometry column’, typically called ‘geom’ or ‘geometry’, extending the data frame class we’ve already seen in <code>crashes</code>, created in Section 5 (repeated here to consolidate data frame creation):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>crashes <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">casualty_type =</span> <span class="fu">c</span>(<span class="st">"pedestrian"</span>, <span class="st">"cyclist"</span>, <span class="st">"cat"</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">casualty_age =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">20</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">by =</span> <span class="dv">20</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vehicle_type =</span> <span class="fu">c</span>(<span class="st">"car"</span>, <span class="st">"bus"</span>, <span class="st">"tank"</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dark =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create an <code>sf</code> data frame called <code>crashes_sf</code> that expands the <code>crashes</code> data frame to include a geometry column based on the <code>crashes</code> longitude and latitude data as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>crashes_sf <span class="ot">=</span> crashes <span class="co"># create copy of crashes dataset</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>crashes_sf<span class="sc">$</span>longitude <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="sc">-</span><span class="fl">1.2</span>, <span class="sc">-</span><span class="fl">1.1</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>crashes_sf<span class="sc">$</span>latitude <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">50.7</span>, <span class="fl">50.7</span>, <span class="fl">50.68</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>crashes_sf <span class="ot">=</span> <span class="fu">st_as_sf</span>(crashes_sf, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) <span class="co"># st_as_sf converts longitude and latitude coordinates into spatial objects using a specified Coordinate Reference System (see 7.6)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Exercises:</strong></p>
<ol type="1">
<li>Plot only the geometry column of <code>crashes_sf</code> (<strong>Hint:</strong> the solution may contain <code>$geometry</code>). If the result is like that in <a href="#fig-crashes-sf-ex-1" class="quarto-xref">Figure&nbsp;<span>7.1</span></a>, congratulations, it worked!</li>
<li>Plot <code>crashes_sf</code>, only showing the age variable.</li>
<li>Plot the 2<sup>nd</sup> and 3<sup>rd</sup> crashes, showing which happened in the dark.</li>
<li><strong>Bonus:</strong> How far apart are the points? (<strong>Hint:</strong> <code>sf</code> functions begin with <code>st_</code>)</li>
<li><strong>Bonus:</strong> Near which settlement did the tank runover the cat?</li>
</ol>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(crashes_sf<span class="sc">$</span>geometry)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(crashes_sf[<span class="st">"casualty_age"</span>])</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(crashes_sf[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"dark"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-crashes-sf-ex-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-crashes-sf-ex-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-space_files/figure-html/fig-crashes-sf-ex-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-crashes-sf-ex-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.1: The <code>crashes_sf</code> dataset shown in map form with the function <code>plot()</code>.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-crashes-sf-ex-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-crashes-sf-ex-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-space_files/figure-html/fig-crashes-sf-ex-2.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-crashes-sf-ex-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.2: The <code>crashes_sf</code> dataset shown in map form with the function <code>plot()</code>.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-crashes-sf-ex-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-crashes-sf-ex-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-space_files/figure-html/fig-crashes-sf-ex-3.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-crashes-sf-ex-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.3: The <code>crashes_sf</code> dataset shown in map form with the function <code>plot()</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="reading-and-writing-spatial-data" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="reading-and-writing-spatial-data"><span class="header-section-number">7.2</span> Reading and writing spatial data</h2>
<p>You can read and write spatial data with <code>read_sf()</code> and <code>write_sf()</code>, as shown below (see <code>?read_sf</code>):</p>
<p>First, let’s create the <code>zones</code> object that we’ll use for demonstration:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>zones <span class="ot">=</span> pct<span class="sc">::</span><span class="fu">get_pct_zones</span>(<span class="st">"isle-of-wight"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can read and write spatial data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_sf</span>(zones, <span class="st">"zones.geojson"</span>) <span class="co"># saves the spatial dataset called zones as geojson file type</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_sf</span>(zones, <span class="st">"zmapinfo"</span>, <span class="at">driver =</span> <span class="st">"MapInfo file"</span>) <span class="co"># saves the dataset as a MapInfo file</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">read_sf</span>(<span class="st">"zmapinfo"</span>) <span class="co"># reads-in mapinfo file</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>See <a href="https://geocompr.robinlovelace.net/read-write.html">Chapter 6</a> of <em>Geocomputation with R</em> for further information.</p>
</section>
<section id="sf-polygons" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="sf-polygons"><span class="header-section-number">7.3</span> sf polygons</h2>
<p><code>sf</code> objects can also represent administrative zones. This is illustrated below with reference to <code>zones</code>, a spatial object representing the Isle of Wight, that we created in the previous section. <strong>Exercises:</strong></p>
<ol type="1">
<li>What is the class of the <code>zones</code> object?</li>
<li>What are its column names?</li>
<li>Print its first 2 rows and columns 6:8 (the result is below).</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 2 features and 5 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -1.301131 ymin: 50.69052 xmax: -1.28837 ymax: 50.70547
Geodetic CRS:  WGS 84
# A tibble: 2 × 6
  geo_code    all bicycle  foot car_driver                              geometry
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;                    &lt;MULTIPOLYGON [°]&gt;
1 E01017326   698      23   285        286 (((-1.289993 50.69766, -1.290177 50.…
2 E01017327   720      25   225        374 (((-1.295712 50.69383, -1.29873 50.6…</code></pre>
</div>
</div>
</section>
<section id="spatial-subsetting-and-sf-plotting" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="spatial-subsetting-and-sf-plotting"><span class="header-section-number">7.4</span> Spatial subsetting and sf plotting</h2>
<p>Like index and value subsetting, spatial subsetting can be done with the <code>[]</code> notation. We can identify the crashes (<code>crashes_sf</code>) that occur in the Isle of Wight (<code>zones</code>) by subsetting as follows (i.e.&nbsp;subset <code>zones</code> by whether it contains data in <code>crashes_sf</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>zones_containing_crashes <span class="ot">=</span> zones[crashes_sf, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To plot a new layer on top of an existing <code>sf</code> plot, use the <code>add = TRUE</code> argument, e.g.&nbsp;as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(zones<span class="sc">$</span>geometry) <span class="co"># plot just the geometry of one layer</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(zones_containing_crashes<span class="sc">$</span>geometry, <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Remember to plot only the <code>geometry</code> column of objects to avoid multiple maps. Colours can be set with the <code>col</code> argument.</p>
<p><strong>Exercises:</strong></p>
<ol type="1">
<li>Plot the geometry of the zones, with the zones containing crashes overlaid on top in red (see <a href="#fig-sp-ex-1" class="quarto-xref">Figure&nbsp;<span>7.4</span></a>).</li>
<li>Plot the zone containing the 2<sup>nd</sup> crash in blue (see <a href="#fig-sp-ex-2" class="quarto-xref">Figure&nbsp;<span>7.5</span></a>).</li>
<li><strong>Bonus:</strong> Plot all zones that intersect with a zone containing crashes, with the actual crash points plotted in black (see <a href="#fig-sp-ex-3" class="quarto-xref">Figure&nbsp;<span>7.6</span></a>).</li>
</ol>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(zones<span class="sc">$</span>geometry)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(zones_containing_crashes<span class="sc">$</span>geometry, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(zones<span class="sc">$</span>geometry)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(zones[crashes_sf[<span class="dv">2</span>, ], ], <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(zones<span class="sc">$</span>geometry)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(zones[zones_containing_crashes, ], <span class="at">col =</span> <span class="st">"yellow"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(crashes_sf<span class="sc">$</span>geometry, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-sp-ex-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sp-ex-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-space_files/figure-html/fig-sp-ex-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sp-ex-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.4: Illustration of the results of spatial subsetting.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-sp-ex-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sp-ex-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-space_files/figure-html/fig-sp-ex-2.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sp-ex-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.5: Illustration of the results of spatial subsetting.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-sp-ex-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sp-ex-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-space_files/figure-html/fig-sp-ex-3.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sp-ex-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.6: Illustration of the results of spatial subsetting.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="geographic-joins" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="geographic-joins"><span class="header-section-number">7.5</span> Geographic joins</h2>
<p>Geographic joins involve assigning values from one object to a new column in another, based on the geographic relationship between them. With <code>sf</code> objects, the data from the <code>crashes_sf</code> dataset is joined onto the ‘target’ <code>zones</code> dataset, to create a new object called <code>zones_joined</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>zones_joined <span class="ot">=</span> <span class="fu">st_join</span>(zones[<span class="dv">1</span>], crashes_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above code takes the <code>geo_code</code> column data from <code>zones</code>, matches it to the <code>geometry</code> column in <code>crashes_sf</code> and then joins it to the crashes that have occurred in those geo_codes. The matched, joined <code>geo_code</code> is a new column in the <code>zone_joined</code> dataset. We now know the administrative geo_code in which each crash occured.</p>
<p><strong>Exercises:</strong></p>
<ol type="1">
<li>Plot the <code>casualty_age</code> variable of the new <code>zones_joined</code> object (see <a href="#fig-joinf-1" class="quarto-xref">Figure&nbsp;<span>7.7</span></a>, to verify the result).</li>
<li>How many zones are returned in the previous command?</li>
<li>Select only the <code>geo_code</code> column from the <code>zones</code> and the <code>dark</code> column from <code>crashes_sf</code> and use the <code>left = FALSE</code> argument to return only zones in which crashes occurred. Plot the result. (<strong>Hint:</strong> it should look like the map shown in <a href="#fig-joinf-2" class="quarto-xref">Figure&nbsp;<span>7.8</span></a>)</li>
</ol>
<p>See <a href="https://geocompr.robinlovelace.net/spatial-operations.html#spatial-joining">Chapter 4</a> of <em>Geocomputation with R</em> for further information on geographic joins.</p>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(zones_joined[<span class="st">"casualty_age"</span>])</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>zjd <span class="ot">=</span> <span class="fu">st_join</span>(zones[<span class="dv">1</span>], crashes_sf[<span class="st">"dark"</span>], <span class="at">left =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(zjd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-joinf-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-joinf-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-space_files/figure-html/fig-joinf-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-joinf-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.7: Illustration of geographic joins.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-joinf-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-joinf-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-space_files/figure-html/fig-joinf-2.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-joinf-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.8: Illustration of geographic joins.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="coordinate-reference-systems" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="coordinate-reference-systems"><span class="header-section-number">7.6</span> Coordinate Reference Systems</h2>
<p>A Coordinate Reference Systems (CRS) is used for plotting data on maps. There are many systems in use but they can generally be classified into two groups; ‘projected’ and ‘geographic’. A projected system, such as Eastings/Northings, plots locations onto a flat 2D projection of the Earth’s surface. A geographic system, such as Longitude/Latitude, refers to locations on the 3D surface of the globe. Distance and direction calculations work differently between geographic and projected CRSs, so it is often necessary to convert from one to another. Fortunately, R makes this very easy, and every CRS has its own unique reference number. For example, 27700 for the British National Grid system.</p>
<p>CRSs define how two-dimensional points (such as longitude and latitude) are actually represented in the real world. A CRS value is needed to interpret and give true meaning to coordinates. You can get and set CRSs with the command <code>st_crs()</code>. Transform CRSs with the command <code>st_transform()</code>, as demonstrated in the code chunk below, which converts the ‘lon/lat’ geographic CRS of <code>crashes_sf</code> into the projected CRS of the British National Grid:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>crashes_osgb <span class="ot">=</span> <span class="fu">st_transform</span>(crashes_sf, <span class="dv">27700</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Exercises:</strong></p>
<ol type="1">
<li>Try to subset the zones with the <code>crashes_osgb</code>. What does the error message say?</li>
<li>Create <code>zones_osgb</code> by transforming the <code>zones</code> object.</li>
<li><strong>Bonus:</strong> Use <code>st_crs()</code> to find out the units measurement of the British National Grid.</li>
</ol>
<p>For more information on CRSs see <a href="https://geocompr.robinlovelace.net/reproj-geo-data.html">Chapter 6</a> of <em>Geocompuation with R</em>.</p>
</section>
<section id="buffers" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="buffers"><span class="header-section-number">7.7</span> Buffers</h2>
<p>Buffers are polygons surrounding geometries, usually with fixed distance. For example, in road safety research a 30m buffer can be created around crash locations to identify crashes that happened in close proximity to a particular junction or road segment.</p>
<p><strong>Exercises:</strong></p>
<ol type="1">
<li>Find out and read the help page of <code>sf</code>’s buffer function.</li>
<li>Create an object called <code>crashes_1km_buffer</code> representing the area within 1 km of the <code>crashes_osgb</code> object and plot the result using the command: <code>plot(crashes_1km_buffer)</code>. As a fun bonus, try: <code>mapview::mapview(crashes_1km_buffer)</code>.</li>
<li><strong>Bonus:</strong> Try creating buffers on the geographic version of the <code>crashes_sf</code> object. What happens?</li>
</ol>
</section>
<section id="attribute-operations-on-sf-objects" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="attribute-operations-on-sf-objects"><span class="header-section-number">7.8</span> Attribute operations on sf objects</h2>
<p>We can do non-spatial operations on <code>sf</code> objects because they are <code>data.frame</code>s. Try the following attribute operations on the <code>zones</code> data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use the zones dataset we created earlier</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>sel <span class="ot">=</span> zones<span class="sc">$</span>all <span class="sc">&gt;</span> <span class="dv">3000</span>  <span class="co"># create a subsetting object</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>zones_large <span class="ot">=</span> zones[sel, ] <span class="co"># subset areas with a population over 3,000</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>zones_2 <span class="ot">=</span> zones[zones<span class="sc">$</span>geo_name <span class="sc">==</span> <span class="st">"Isle of Wight 002"</span>,] <span class="co"># subset based on 'equality' query</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>zones_first_and_third_column <span class="ot">=</span> zones[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)]</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>zones_just_all <span class="ot">=</span> zones[<span class="st">"all"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Exercises:</strong></p>
<ol type="1">
<li>Practice the subsetting techniques you have learned on the <code>sf data.frame</code> object <code>zones</code>:
<ul>
<li>Create an object called <code>zones_small</code>, which contains only regions with less than 3000 people in the <code>all</code> column.</li>
<li>Create a selection object called <code>sel_high_car</code> which is <code>TRUE</code> for regions with above median numbers of people who travel by car and <code>FALSE</code> otherwise.</li>
<li>Create an object called <code>zones_foot</code> which contains only the foot attribute from <code>zones</code>.</li>
<li><strong>Bonus 1:</strong> plot <code>zones_foot</code> using the function <code>plot</code> to show where walking is a popular mode of travel to work.</li>
<li><strong>Bonus 2:</strong> building on your answers to previous questions, use <code>filter()</code> from the <code>dplyr</code> package to subset small regions where car use is high.</li>
</ul></li>
<li><strong>Bonus:</strong> What is the population density of each region (<strong>Hint:</strong> you may need to use the functions <code>st_area()</code>, <code>as.numeric()</code> and use the ‘all’ column)?</li>
<li><strong>Bonus:</strong> Which zone has the highest percentage of people who cycle?</li>
</ol>
</section>
<section id="mapping-road-crash-data" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="mapping-road-crash-data"><span class="header-section-number">7.9</span> Mapping road crash data</h2>
<p>So far we have used the <code>plot()</code> function to make maps. That’s fine for basic visualisation, but for publication-quality maps we recommend using <code>tmap</code>. See Chapter 8 of <em>Geocomputation with R</em> for further explanation and alternatives. After installation, load the package as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>) <span class="co"># this sets the tmap mode to plotting as opposed to interactive</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ tmap mode set to "plot".</code></pre>
</div>
</div>
<p><strong>Exercises:</strong></p>
<ol type="1">
<li>Create the plots of the <code>zones</code> object using <code>plot()</code> and <code>tm_shape() + tm_polygons()</code> functions (see <a href="#fig-plot3-1" class="quarto-xref">Figure&nbsp;<span>7.9</span></a>).</li>
<li>Create an interactive version of the <code>tmap</code> plot by setting <code>tmap_mode("view")</code> and re-running the plotting commands.</li>
<li>Add an additional layer to the interactive map showing the location of crashes, using marker and dot symbols.</li>
<li><strong>Bonus:</strong> Change the default basemap (<strong>Hint:</strong> you may need to search in the package documentation or online for the solution).</li>
</ol>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(zones[<span class="fu">c</span>(<span class="st">"all"</span>, <span class="st">"bicycle"</span>)])</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(zones) <span class="sc">+</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="fu">c</span>(<span class="st">"all"</span>, <span class="st">"bicycle"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-plot3-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-space_files/figure-html/fig-plot3-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot3-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.9: Illustration of the plot and tmap approaches for creating maps.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-plot3-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-space_files/figure-html/fig-plot3-2.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.10: Illustration of the plot and tmap approaches for creating maps.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="analysing-point-data" class="level2" data-number="7.10">
<h2 data-number="7.10" class="anchored" data-anchor-id="analysing-point-data"><span class="header-section-number">7.10</span> Analysing point data</h2>
<p>Based on the saying, “Don’t run before you can walk,” we’ve learned the vital foundations of R before tackling a real dataset. Temporal and spatial attributes are key to road crash data, hence the emphasis on <code>lubridate</code> and <code>sf</code>. Visualisation is central to understanding data and influencing policy, which is where <code>tmap</code> comes in. With these solid foundations, plus knowledge of how to ask for help (we recommend reading R’s internal help, asking colleagues, searching the internet and creating new questions or comments on online forums such as StackOverflow or GitHub and we suggest you follow this order of resources to get help), you are ready to test the methods on some real data.</p>
<p>Before doing so, take a read of the <code>stats19</code> vignette, which can be launched as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vignette</span>(<span class="at">package =</span> <span class="st">"stats19"</span>) <span class="co"># view all vignettes available on stats19</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">"stats19"</span>) <span class="co"># view the introductory vignette</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This should now be sufficient to tackle the following exercises:</p>
<ol type="1">
<li>Download and plot all crashes reported in Great Britain in 2023. (<strong>Hint:</strong> see <a href="https://docs.ropensci.org/stats19/articles/stats19.html">the stats19 vignette</a>)</li>
<li>Find the function in the <code>stats19</code> package that converts a <code>data.frame</code> object into an <code>sf</code> data frame. Use this function to convert the road crashes into an <code>sf</code> object, called <code>crashes_sf</code>, for example.</li>
<li>Filter crashes that happened in the Isle of Wight based on attribute data. (<strong>Hint:</strong> the relevant column contains the word <code>local</code>)</li>
<li>Filter crashes happened in the Isle of Wight using geographic subsetting. (<strong>Hint:</strong> remember <code>st_crs()</code>?)</li>
<li><strong>Bonus:</strong> Which type of subsetting yielded more results and why?</li>
<li><strong>Bonus:</strong> How many crashes happened in each zone?</li>
<li>Create a new column called <code>month</code> in the crash data using the function <code>lubridate::month()</code> and the <code>date</code> column.</li>
<li>Create an object called <code>a_zones_may</code> representing all the crashes that happened in the Isle of Wight in the month of May.</li>
<li><strong>Bonus:</strong> Calculate the average (<code>mean</code>) speed limit associated with each crash that happened in May across the zones of the Isle of Wight (the result is shown in the map).</li>
</ol>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-iowbuff-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-iowbuff-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-space_files/figure-html/fig-iowbuff-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-iowbuff-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.11: Maps of the Isle of Wight.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-iowbuff-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-iowbuff-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-space_files/figure-html/fig-iowbuff-2.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-iowbuff-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.12: Maps of the Isle of Wight.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"itsleeds/osmextract"</span>) <span class="co"># install github package for osm data</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(osmextract)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>region_name <span class="ot">=</span> <span class="st">"essex"</span> <span class="co"># "essex" can be changed to another area name as required</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>osm_data <span class="ot">=</span> <span class="fu">oe_get</span>(region_name, <span class="at">extra_tags =</span> <span class="fu">c</span>(<span class="st">"maxspeed"</span>, <span class="st">"ref"</span>))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(osm_data<span class="sc">$</span>highway)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#filter osm_data to show only major roads</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>roads <span class="ot">=</span> osm_data <span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(highway, <span class="at">pattern =</span> <span class="st">"moto|prim|seco|tert|trunk"</span>))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># transform geometry and save</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>roads <span class="ot">=</span> <span class="fu">st_transform</span>(roads, <span class="dv">27700</span>) <span class="co">#converts to projected BNG system for later use</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(roads$geometry) # basic plot of roads</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(roads) <span class="sc">+</span> <span class="fu">tm_lines</span>(<span class="st">"maxspeed"</span>, <span class="at">showNA =</span> T, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(roads, <span class="at">file =</span> <span class="st">"roads.Rds"</span>) <span class="co"># Saves road dataset for future use</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── tmap v3 code detected ───────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[v3-&gt;v4] `tm_lines()`: migrate the argument(s) related to the legend of the
visual variable `col` namely 'showNA' to 'col.legend = tm_legend(&lt;HERE&gt;)'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-ex" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ex-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="07-space_files/figure-html/fig-ex-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ex-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.13: Roads in Essex downloaded with the code shown above.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="bonus-exercises" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="bonus-exercises">Bonus exercises</h2>
<p>Identify a region and zonal units of interest from http://geoportal.statistics.gov.uk/ or from the object <code>police_boundaries</code> in the <code>stats19</code> package.</p>
<ol type="1">
<li>Read them into R as an <code>sf</code> object.</li>
<li>Create a map showing the number of crashes in each zone.</li>
<li>Identify the average speed limit associated with crashes in each zone.</li>
<li>Identify an interesting question you can ask to the data and use exploratory data analysis to find answers.</li>
<li>Check another <a href="https://github.com/agila5/leeds_seminar">related project</a> for further information on smoothing techniques of counts on a linear network.</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./06-time.html" class="pagination-link" aria-label="Temporal data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Temporal data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08-join.html" class="pagination-link" aria-label="Joining road crash tables">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Joining road crash tables</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/itsleeds/rrsrr/edit/main/07-space.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/itsleeds/rrsrr/blob/main/07-space.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/itsleeds/rrsrr/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>